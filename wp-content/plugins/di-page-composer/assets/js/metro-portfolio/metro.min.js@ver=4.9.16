var SKMetro={options:{gutter:1,beaconColor:"000000"}};jQuery(document).ready(function(){SKMetro.Plugin.getInstance().init()}),SKMetro.Plugin=function(){var e;this.stuff=function(){};var o=[],t=function(){for(var e=0;e<o.length;e++)p(o[e],parseInt(o[e].containerUI.parent().attr("data-initialload")))},p=function(u,e){u.containerUI.parent().find(".skLoadMoreLink").css("display","none"),u.loadSpinner.css("display","inline-block");for(var t=u.items,h=[],a=0,i=0;i<t.length;i++)if("false"==t[i].objectUI.attr("data-isloaded")&&a<e){var n=new SKMetro.Plugin.ThumbItem(t[i],u);h.push(n),a++}for(i=0;i<h.length;i++)i<h.length-1&&(h[i].next=h[i+1]),i==h.length-1&&h[i].setCallBack(function(){u.loadSpinner.css("display","none");for(var e=0;e<h.length;e++){var t=h[e].getObjectUI(),a=h[e].getItem().metroHTML;if(null!=a){var i=jQuery(a);i.find(".metro-thumb").bind("load",function(){var e=jQuery(this).parent();jQuery(this).css("left",e.width()/2-jQuery(this).width()/2),jQuery(this).css("top",e.height()/2-jQuery(this).height()/2),e.css("backgroundColor","#"+e.attr("data-backgroundcolor")),e.find(".metro-text").css("color","#"+e.attr("data-textcolor"))}),i.appendTo(t.find(".metro_item_inside"));var n=jQuery('<div class="metro-dark"></div>');n.css("opacity",0),n.prependTo(i)}var o=h[e].getItem().captionHTML;if(null!=o){var s=jQuery(o);s.css("opacity",0),s.appendTo(t.find(".metro_item_inside"))}t.find(".metro_item_inside").css("display","block"),u.containerUI.packery("appended",t);var r=t.find(".gr_isotope_beacon"),c=SakuraUtils.hexToRgb(SKMetro.options.beaconColor);r.find(".beaconCircle1").css("backgroundColor","rgba("+c[0]+","+c[1]+","+c[2]+",.4)"),r.find(".beaconCircle2").css("backgroundColor","rgba("+c[0]+","+c[1]+","+c[2]+",.8)"),r.css("opacity",0),r.css("display","block"),t.hover(function(e){var t=jQuery(this).find(".gr_isotope_beacon");if(t.css("left",jQuery(this).width()/2-t.width()/2),t.css("top",jQuery(this).height()/2-t.height()/2),TweenMax.to(t,.2,{css:{opacity:1},ease:Power4.EaseIn}),0!=jQuery(this).find(".metro-caption").length){var a=jQuery(this).find(".metro-caption");a.css("left",0),a.css("top",jQuery(this).find(".metro_item_inside").height()),a.css("opacity",1),TweenMax.to(a,.2,{css:{top:jQuery(this).find(".metro_item_inside").height()-a.height()-5},ease:Power4.EaseIn})}0!=jQuery(this).find(".metro-cover").length&&TweenMax.to(jQuery(this).find(".metro-dark"),.2,{css:{opacity:1},ease:Power4.EaseIn})},function(e){var t=jQuery(this).find(".gr_isotope_beacon");if(TweenMax.to(t,.2,{css:{opacity:0},ease:Power4.EaseIn}),0!=jQuery(this).find(".metro-caption").length){var a=jQuery(this).find(".metro-caption");TweenMax.to(a,.2,{css:{opacity:0,top:jQuery(this).find(".metro_item_inside").height()},ease:Power4.EaseIn})}0!=jQuery(this).find(".metro-cover").length&&TweenMax.to(jQuery(this).find(".metro-dark"),.2,{css:{opacity:0},ease:Power4.EaseIn})}),t.find(".gr_genericBeaconIsotope").hover(function(e){TweenMax.to(jQuery(this).find(".beaconCircle1"),.3,{scale:1.5,opacity:0,ease:Elastic.EaseOut}),TweenMax.to(jQuery(this).find(".beaconCircle2"),.2,{scale:.95,opacity:.7,ease:Elastic.EaseOut})},function(e){TweenMax.to(jQuery(this).find(".beaconCircle1"),.2,{scale:1,opacity:1,ease:Elastic.EaseIn}),TweenMax.to(jQuery(this).find(".beaconCircle2"),.1,{scale:1,opacity:1,ease:Elastic.EaseOut})}),t.click(function(e){e.preventDefault();var t=new Array;if(null!=jQuery(this).attr("data-external-url")){var a=!0;return null!=jQuery(this).attr("data-target")&&(a="_blank"!=jQuery(this).attr("data-target")),void(a?window.location=jQuery(this).attr("data-external-url"):window.open(jQuery(this).attr("data-external-url")))}for(var i=jQuery(this).attr("data-uid"),n=0;n<u.items.length;n++)if(null==u.items[n].objectUI.attr("data-external-url")){var o=u.items[n].type;t.push({imageLargeURL:u.items[n].data.large,type:o,extraData:u.items[n].data.embeded,isLoaded:u.items[n].objectUI.attr("data-isloaded"),uid:u.items[n].uid})}for(var s=0,r=0;r<t.length;r++)if(t[r].uid==i){s=r;break}(new LightBoxTheGrid).init(t,!1,null,s,u,function(e,t){if(0!=parseInt(t)){for(var a=0,i=0;i<e.items.length;i++)if(e.items[i].uid!=t&&"false"==e.items[i].objectUI.attr("data-isloaded"))a++;else if(e.items[i].uid==t&&"false"==e.items[i].objectUI.attr("data-isloaded")){a++;break}p(e,a)}})})}for(var d=0;d<u.items.length;d++){var l=!1;if("false"==u.items[d].objectUI.attr("data-isloaded")){l=!0;break}}l?u.loadMoreBTN.css("display","inline-block"):u.containerUI.parent().find(".loadMoreContainer").remove()});0!=h.length&&h[0].load()};return{getInstance:function(){return e||(e={init:function(){jQuery(".skmetro").each(function(t){jQuery(this).attr("data-index",t);var r=[];jQuery(this).find(".metro_item").each(function(e){var t=jQuery(this).attr("data-type");jQuery(this).attr("data-indx",e);var a=SakuraUtils.generateUID();jQuery(this).attr("data-uid",a),jQuery(this).css("padding",SKMetro.options.gutter.toString());var i,n,o,s=jQuery(this).find("a").attr("href");switch(t){case"image":i={thumb:s,large:jQuery(this).find("a").attr("data-imagelarge")};break;case"video":case"audio":i={thumb:s,embeded:0!=jQuery(this).find("iframe").length?jQuery(this).find("iframe").get(0).outerHTML:""}}0!=jQuery(this).find(".metro-cover").length&&(n=jQuery(this).find(".metro-cover").get(0).outerHTML),0!=jQuery(this).find(".metro-caption").length&&(o=jQuery(this).find(".metro-caption").get(0).outerHTML),jQuery(this).empty(),jQuery(this).attr("data-isloaded","false"),r.push({objectUI:jQuery(this),type:t,data:i,uid:a,metroHTML:n,captionHTML:o}),jQuery(this).remove()});var e=jQuery(this).find(".skmetro_ui"),a=(e.packery({itemSelector:".metro_item",gutter:0}),e.data("packery")),i=jQuery(this).find(".loadMoreContainer").find("img"),n=jQuery(this).find(".skLoadMoreLink");o.push({containerUI:e,items:r,loadMoreBTN:n,loadSpinner:i,indx:t,packeryObj:a}),n.click(function(e){e.preventDefault(),jQuery(this).css("display","none"),p(o[t],parseInt(o[t].containerUI.parent().attr("data-loadmore")))})}),t()}}),e}}}(),SKMetro.Plugin.ThumbItem=function(o,s){this.item=o,this.containerData=s,this.objectUI=o.objectUI,this.next,this.callBack,this.setCallBack=function(e){this.callBack=e},this.load=function(){var e=this,t="magnify_icon_beacon.png";switch(this.item.type){case"video":t="video_icon_beacon.png";break;case"audio":t="sound_icon_beacon.png";break;default:t="magnify_icon_beacon.png"}var a=['<div class="metro_item_inside">','<img class="metroThumb" alt="" />','<div class="gr_isotope_beacon">','<div class="gr_genericBeaconIsotope" data-href="#">','<div class="beaconCircle1"></div>','<div class="beaconCircle2">','<img class="isotopeItemOpenLink" src="/wp-content/plugins/di-page-composer/assets/js/metro-portfolio/img/'+(t=null!=o.objectUI.attr("data-external-url")?"link_icon_beacon.png":t)+'" alt="">',"</div>","</div>","</div>","</div>"].join(""),i=jQuery(a),n=i.find(".metroThumb");n.bind("load",function(){null!=e.next&&e.next.load(),e.callBack&&e.callBack()}),this.objectUI.appendTo(s.containerUI),i.appendTo(this.objectUI),n.attr("src",o.data.thumb),i.parent().attr("data-isloaded","true")},this.getObjectUI=function(){return this.objectUI},this.getItem=function(){return this.item}};var SakuraUtils={hexToRgb:function(e){var t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},generateUID:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}};function LightBoxTheGrid(){var T=!0;this.init=function(n,e,t,o,a,i){null!=o&&null!=o||(o=0),e&&TweenMax.to(t,.2,{css:{opacity:.9,scale:.9},ease:Power4.EaseIn});var s=!1,r=jQuery('<div class="gravityLightboxUI gravityLightboxSettings"></div>');r.css("opacity",0),r.appendTo("body"),r.css("width","80%"),r.css("height","80%"),r.css("left",jQuery(window).width()/2-r.width()/2),r.css("top",130),TweenMax.to(r,.1,{css:{opacity:1,width:"100%",left:0,height:"100%",top:0},ease:Power4.EaseIn,onComplete:function(){v(n[o]),x()}}),jQuery(window).resize(function(){x()});var c=jQuery('<div class="gravityArrow gravityArrowLeft"></div>');c.css("display","none"),c.appendTo(r);var d=jQuery('<div class="gravityArrow gravityArrowRight"></div>');d.css("display","none"),d.appendTo(r);var l=jQuery('<div class="gravityLightCloseUI"><div class="gravityLightClose"></div></div>');l.appendTo(r);var u=l.find(".gravityLightClose"),h=jQuery('<div class="lbgLoader"><img src="/wp-content/plugins/di-page-composer/assets/js/metro-portfolio/img/preloader-lightbox.gif" alt="" /></div>');h.css("opacity",0),h.appendTo(r);for(var p=new Array(c,d,u),y=0;y<p.length;y++)p[y].css("opacity",.7),p[y].hover(function(){TweenMax.to(jQuery(this),.2,{css:{opacity:1},ease:Power4.EaseIn})},function(){TweenMax.to(jQuery(this),.2,{css:{opacity:.7},ease:Power4.EaseIn})});function f(e){e?TweenMax.to(h,.19,{css:{opacity:1,scale:1},ease:Power4.EaseIn}):TweenMax.to(h,.19,{css:{opacity:0,scale:.5},ease:Power4.EaseIn})}function g(){if(null==b)return c.css("display","none"),void d.css("display","none");c.css("display","block"),d.css("display","block"),0==o&&c.css("display","none"),o>=n.length-1&&d.css("display","none")}x(),jQuery(document).bind("keydown",function(e){if(!s)switch(e.keyCode){case 37:0<o&&v(n[--o]);break;case 39:o<n.length-1&&v(n[++o]);break;case 27:I()}}),c.click(function(e){e.preventDefault(),s||0<o&&v(n[--o])}),d.click(function(e){e.preventDefault(),s||o<n.length-1&&v(n[++o])});var m=0;function v(e){switch("false"==e.isLoaded&&(m=e.uid,n[o].isLoaded=!0),e.type){case"image":i=e.imageLargeURL,g(),s=!0,null!=b?(f(!0),TweenMax.to(b,.2,{css:{opacity:0},ease:Power4.EaseIn,onComplete:function(){b.remove(),Q(i)}})):(f(!0),Q(i));break;case"video":a=e.extraData,g(),s=!0,null!=b?(f(!0),TweenMax.to(b,.2,{css:{opacity:0},ease:Power4.EaseIn,onComplete:function(){b.remove(),w(a)}})):(f(!0),w(a));break;case"audio":t=e.extraData,g(),s=!0,null!=b?(f(!0),TweenMax.to(b,.2,{css:{opacity:0},ease:Power4.EaseIn,onComplete:function(){b.remove(),j(t)}})):(f(!0),j(t))}var t,a,i}function j(e){try{(b=jQuery('<div class="gridSound">'+e+"</div>")).css("opacity",0),b.appendTo(r),TweenMax.to(b,.2,{css:{opacity:1},ease:Power4.EaseIn}),f(!1),x(),s=!1}catch(e){}g()}function w(e){try{(b=jQuery('<div class="gridVideo">'+e+"</div>")).css("opacity",0),b.appendTo(r),TweenMax.to(b,.2,{css:{opacity:1},ease:Power4.EaseIn}),f(!1),x(),s=!1}catch(e){}g()}var b=null;function Q(e){try{(b=jQuery('<img class="gravityLightboxImage" src="'+e+'" alt="" />')).css("opacity",0),b.bind("load",function(){x(),b.unbind("load"),f(!1),TweenMax.to(b,.2,{css:{opacity:1},ease:Power4.EaseIn})}),b.appendTo(r);try{b.unbind("contextmenu"),b.bind("contextmenu",function(e){return!1})}catch(e){}s=!1}catch(e){}g()}function I(){null!=i&&i(a,m),T=!1,e?(TweenMax.to(r,.2,{css:{opacity:.2,scale:1.3},ease:Power4.EaseIn}),TweenMax.to(t,.2,{css:{opacity:1,scale:1},delay:.1,ease:Power4.EaseIn,onComplete:function(){r.remove()}})):null!=b?(TweenMax.to(b,.1,{css:{opacity:0,scale:.8},ease:Power4.EaseIn,onComplete:function(){TweenMax.to(r,.2,{css:{opacity:0},delay:.2,ease:Power4.EaseIn,onComplete:function(){r.remove()}})}}),TweenMax.to(d,.1,{css:{opacity:0},ease:Power4.EaseIn}),TweenMax.to(c,.1,{css:{opacity:0},ease:Power4.EaseIn}),jQuery(this).css("display","none")):r.remove(),jQuery(document).unbind("keydown")}function x(){if(T){try{b.css("left",r.width()/2-b.width()/2+"px"),b.css("top",r.height()/2-b.height()/2+"px")}catch(e){}try{c.css("left","20px"),c.css("top",r.height()/2-c.height()/2+"px"),d.css("right","20px"),d.css("top",r.height()/2-d.height()/2+"px"),l.css("bottom","20px"),l.css("left",r.width()/2-21+"px"),h.css("left",r.width()/2-15+"px"),h.css("top",r.height()/2-15+"px")}catch(e){}}}u.hover(function(e){TweenMax.to(jQuery(this),.2,{css:{scale:.9},ease:Power4.EaseIn})},function(e){TweenMax.to(jQuery(this),.2,{css:{scale:1},ease:Power4.EaseIn})}),l.click(function(e){e.preventDefault(),I()})}}