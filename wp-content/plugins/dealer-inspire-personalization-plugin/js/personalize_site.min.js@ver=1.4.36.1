var Utils={extend:function(t,e){if(e=JSON.parse(JSON.stringify(e)),"string"==typeof t)return e;var i;for(var s in t)i=t[s],t.hasOwnProperty(s)&&void 0!==i&&(e[s]=i);return e},queue:function(){var t=[];function e(){var i=t.shift();i&&i(e)}return function(i){t.push(i),1==t.length&&e()}}(),setcss:function(){var t=["Webkit","O","Moz","ms"],e={};function i(i){return i=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),e[i]||(e[i]=function(e){var i=document.body.style;if(e in i)return e;for(var s,n=t.length,r=e.charAt(0).toUpperCase()+e.slice(1);n--;)if((s=t[n]+r)in i)return s;return e}(i))}function s(t,e,s){e=i(e),t.style[e]=s}return function(t,e){var i,n,r=arguments;if(2==r.length)for(i in e)void 0!==(n=e[i])&&e.hasOwnProperty(i)&&s(t,i,n);else s(t,r[1],r[2])}}(),clamp:function(t,e,i){return t<e?e:t>i?i:t},toBarPerc:function(t){return 100*(-1+t)},hasClass:function(t,e){return("string"==typeof t?t:Utils.classList(t)).indexOf(" "+e+" ")>=0},addClass:function(t,e){var i=Utils.classList(t),s=i+e;Utils.hasClass(i,e)||(t.className=s.substring(1))},removeClass:function(t,e){var i,s=Utils.classList(t);Utils.hasClass(t,e)&&(i=s.replace(" "+e+" "," "),t.className=i.substring(1,i.length-1))},showEl:function(t){Utils.setcss(t,{display:"block"})},hideEl:function(t){Utils.setcss(t,{display:"none"})},classList:function(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")},removeElement:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}};!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Mprogress=e()}("undefined"!=typeof window?window:this,function(){"use strict";var t,e,i={template:1,parent:"body",start:!1,minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800},s={determinate:'<div class="deter-bar" role="mpbar1"><div class="peg"></div></div><div class="bar-bg"></div>',buffer:'<div class="deter-bar" role="mpbar2"><div class="peg"></div></div><div class="buffer-bg" role="bufferBar"></div><div class="mp-ui-dashed" role="dashed"></div>',indeterminate:'<div class="indeter-bar" role="mpbar3"></div><div class="bar-bg"></div>',query:'<div class="query-bar" role="mpbar4"><div class="peg"></div></div><div class="bar-bg"></div>'},n={},r=function(t){this.options=t||{},this.status=null,this.bufferStatus=null,this._inst=MProgress_instances++};return r.prototype={version:"0.1.0",constructor:r,start:function(){if(this.status||this._isBufferStyle()||this.set(0),this._isIndeterminateStyle()||this._isQueryStyle())return this;var t=this;if(this._isBufferStyle()&&!this.bufferStatus){var e=this._render(),i=e.querySelector('[role="dashed"]'),s=e.querySelector(this._getCurrSelector());Utils.hideEl(s),Utils.hideEl(i),this.setBuffer(0).setBuffer(1),setTimeout(function(){Utils.showEl(i),Utils.showEl(s),t.set(0).setBuffer(0)},500)}return this.options.trickle&&function e(){setTimeout(function(){t.status&&(t._trickle(),e())},t.options.trickleSpeed)}(),this},end:function(t){if(!t&&!this.status)return this;var e=this,i=this.options.speed,s=this._getRenderedId();if(this._isBufferStyle()&&t)return this.set(0).set(1);if(this._isIndeterminateStyle())return!this._isRendered()&&t&&(this.set(0),s=this._getRenderedId(),i=500),Utils.setcss(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout(function(){Utils.setcss(s,{transition:"all "+i+"ms linear",opacity:0}),setTimeout(function(){e._remove()},i)},i),this;if(this._isQueryStyle()){if(this._isRendered()){var n=s.querySelector(this._getCurrSelector());return Utils.addClass(n,"end"),setTimeout(function(){e._remove()},1500),this}if(t)return this.set(0),s=this._getRenderedId(),setTimeout(function(){e._remove()},1500),this}return this.inc(.3+.5*Math.random()).set(1)},set:function(t){return t=Utils.clamp(t,this.options.minimum,1),this.status=1===t?null:t,this._setProgress(this._getCurrSelector(),t),this},setBuffer:function(t){return t=Utils.clamp(t,this.options.minimum,1),this.bufferStatus=1===t?null:t,this._setProgress('[role="bufferBar"]',t),this},inc:function(t){var e=this.status,i=this.bufferStatus;return e?(e=this._getRandomNum(e,t),this._isBufferStyle()&&(i=this._getRandomNum(i>e?i:e+.1,t),this.setBuffer(i)),this.set(e)):this.start()},_trickle:function(){return this.inc(Math.random()*this.options.trickleRate)},_render:function(t){if(this._isRendered())return this._getRenderedId();var e,i=document.createElement("div"),s=this._getCurrTemplate()||"",n=document.querySelector(this.options.parent);if(i.id=this._getRenderedId(!0),i.className="ui-mprogress",i.innerHTML=s,!this._isIndeterminateStyle()&&!this._isQueryStyle()){t||(e=!this._isStarted());var r=i.querySelector(this._getCurrSelector()),o=e?"-100":Utils.toBarPerc(this.status||0);if(Utils.setcss(r,{transition:"all 0 linear",transform:"translate3d("+o+"%,0,0)"}),this._isBufferStyle()){var a=i.querySelector('[role="bufferBar"]'),u=e?"-100":Utils.toBarPerc(this.bufferStatus||0);Utils.setcss(a,{transition:"all 0 linear",transform:"translate3d("+u+"%,0,0)"})}}return n!=document.body&&Utils.addClass(n,"mprogress-custom-parent"),n.appendChild(i),i},_remove:function(){var t=this._getRenderedId(),e=document.querySelector(this.options.parent);e!=document.body&&Utils.removeClass(e,"mprogress-custom-parent");var i=this.options.parent+this.options.template;n[i]&&(n[i]=null),t&&(this.status=null,this.bufferStatus=null,Utils.removeElement(t))},_setProgress:function(t,e){var i=this._render(),s=i.querySelector(t),n=this.options.speed,r=this.options.easing,o=this;if(i.offsetWidth,this._isIndeterminateStyle()||this._isQueryStyle())return this;Utils.queue(function(t){""===o.options.positionUsing&&(o.options.positionUsing=o._getPositioningCSS()),Utils.setcss(s,o._barPositionCSS(e,n,r)),1===e?(Utils.setcss(i,{transition:"none",opacity:1}),i.offsetWidth,setTimeout(function(){Utils.setcss(i,{transition:"all "+n+"ms linear",opacity:0}),setTimeout(function(){o._remove(),t()},n)},n)):setTimeout(t,n)})},_getCurrSelector:function(){var t=this._getCurrTplId();return"99"!==t?'[role="mpbar'+t+'"]':'[role="mpbar"]'},_isStarted:function(){return"number"==typeof this.status},_getRandomNum:function(t,e){return"number"!=typeof e&&(e=(1-t)*Utils.clamp(Math.random()*t,.1,.95)),t=Utils.clamp(t+e,0,.994)},_isRendered:function(){return!!this._getRenderedId()},_getRenderedId:function(t){var e="mprogress"+this._getCurrTplId()+"_"+this._inst;return t?e:document.getElementById(e)},_isBufferStyle:function(){return 2===this._getCurrTplId()},_isIndeterminateStyle:function(){return 3===this._getCurrTplId()},_isQueryStyle:function(){return 4===this._getCurrTplId()},_getCurrTplId:function(){var t=~~this.options.template||1;return"number"==typeof t?t:"99"},_getCurrTemplate:function(){var t=this.options.template||1;return"number"==typeof~~t?s[["determinate","buffer","indeterminate","query"][t-1]]||"":"string"==typeof t?template:void 0},_getPositioningCSS:function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"},_barPositionCSS:function(t,e,i){var s;return(s="translate3d"===this.options.positionUsing?{transform:"translate3d("+Utils.toBarPerc(t)+"%,0,0)"}:"translate"===this.options.positionUsing?{transform:"translate("+Utils.toBarPerc(t)+"%,0)"}:{"margin-left":Utils.toBarPerc(t)+"%"}).transition="all "+e+"ms "+i,s}},t=0,e=0,r.prototype.promise=function(i){if(!i||"resolved"==i.state())return this;var s=this;return 0==e&&s.start(),t++,e++,i.always(function(){0==--e?(t=0,s.end()):s.set((t-e)/t)}),this},function(t){var e=Utils.extend(t,i),s=e.parent+e.template,o=n[s]||"";return o||(o=new r(e),n[s]=o),"string"==typeof t&&"function"==typeof o[t]?o[t]():e.start&&o.start(),o}});var MProgress_instances=0,DI_Personalization_Site={init_time:null,fade_time:500,max_geolocation_wait:4e3,hooks:{},init:function(){var t=this,e=0,i=[],s=[];this.init_time=new Date,jQuery(".di_personalize").each(function(){var n=jQuery(this);n.attr("id","di_personalize_"+e),n.css("text-align","center");var r=t.attrs(n),o=r.time/r.messages.length,a=t.get_default_message(r);"none"!=r.loading_type&&a&&(t.set_loading_message(r,o),"circle"==r.loading_type?t.add_loader_circle(r):t.add_loader_bar(r)),r.key=n.attr("key"),i.push(r),s.push(n.attr("key")),e++}),this.find_matches(s,i)},queryString:function(t){try{q=location.search.substring(1),v=q.split("&");for(var e=0;e<v.length;e++)if(p=v[e].split("="),p[0]==t)return-1!=p[1].indexOf("%20")?decodeURIComponent(p[1]):p[1]}catch(t){"undefined"!=typeof console&&console.log(t)}},find_matches:function(t,e){var i=this;if("undefined"!=typeof DIGeoLocation&&DIGeoLocation.stillLoading()&&this.max_geolocation_wait>0)return this.max_geolocation_wait-=100,void setTimeout(function(){i.find_matches(t,e)},100);var s=null;"undefined"!=typeof inventory_localization&&void 0!==inventory_localization.vehicle&&(s=inventory_localization.vehicle);var n={type:"POST",url:di_personalize.ajax_url+"?action=personalize",data:{keys:t,slug:di_personalize.slug,referer:document.referrer,utm_source:this.queryString("utm_source"),utm_medium:this.queryString("utm_medium"),utm_campaign:this.queryString("utm_campaign"),utm_content:this.queryString("utm_content"),vehicle:s},dataType:"JSON"},r=function(t){i.fire_hook("pre_update"),t&&""==t.error&&t.items?i.update_original_content(e,t):i.use_all_default_messages(e),i.fire_hook("post_update")},o=function(){i.fire_hook("pre_update"),i.use_all_default_messages(e),i.fire_hook("post_update")},a=function(){jQuery.ajax(n).success(r).fail(o)};"complete"===document.readyState?a():jQuery(window).on("load",a)},update_original_content:function(t,e){for(var i={},s="",n=0;n<t.length;n++){var r=t[n].key;r in e.items?((s=e.items[t[n].key].match(/DI_PZ key='[^']+' tag='([^']+)'/))[1]&&(s=s[1]),this.prepare_content(t[n],e.items[r])):(s="Default Shown",this.use_default_message(t[n])),t[n].tag=s,r in i||(i[r]=!0,this.track_shown_event(r,s))}},use_all_default_messages:function(t){for(var e=0;e<t.length;e++)this.use_default_message(t[e])},get_default_message:function(t){return jQuery("div.di_personalize_default",t.node).html()},track_shown_event:function(t,e){if("undefined"!=typeof dataLayer&&dataLayer&&t){var i={event:"personalization",eventCategory:"Personalization",eventAction:"Shown",eventLabel:"Key: "+t+" Tag:"+e+" Page:"+window.location.href,nonInteraction:!0};dataLayer.push(i)}},use_default_message:function(t){this.prepare_content(t,this.get_default_message(t))},set_loading_message:function(t,e){var i=this;jQuery(".di_personalize_loading_message",t.node).html(t.messages.shift()),t.messages.length>0&&setTimeout(function(){i.set_loading_message(t,e)},e)},prepare_content:function(t,e){var i=this,s=new Date-this.init_time,n=t.time-s;n<=0?this.fadeout_placeholder(t,e):setTimeout(function(){i.fadeout_placeholder(t,e)},n)},fadeout_placeholder:function(t,e){var i=this;t.node=jQuery("#"+t.node.attr("id")),t.node.fadeOut(this.fade_time/2,function(){i.fadein_content(t,e)})},fadein_content:function(t,e){var i=t.key,s=t.tag;t.node.css("text-align","inherit"),t.node.html(e),jQuery("a",t.node).click(function(){DI_Personalization_Site.track_click_event(jQuery(this),i,s)}),t.node.fadeIn(this.fade_time/2),this.fire_hook("content_ready")},track_click_event:function(t,e,i){if("undefined"!=typeof dataLayer&&dataLayer&&e&&i){var s={event:"personalization-click",eventCategory:"Personalization",eventAction:"Click",eventLabel:"Key: "+e+" Tag:"+i+" Dest:"+t.attr("href")};dataLayer.push(s)}var n=t.data("is_cta"),r="CTA",o=t.text().trim();void 0!==n&&null!=n&&0==n&&(r="Button"),o||(o=t.attr("href")),jQuery(document).trigger("di_ev",{name:"click",label:r,default_score:0,custom_data:{button:{text:o,interface:"personalizer"}}})},attrs:function(t){var e={};return void 0!==jQuery(".di_personalize_customized",t).attr("data")&&(e=JSON.parse(jQuery(".di_personalize_customized",t).attr("data"))),"messages"in e||(e.messages=["Loading customized content..."]),"time"in e||(e.time=2),"size"in e||(e.size=30),"loading_type"in e||(e.loading_type="line"),e.node=jQuery(t),e},add_loader_circle:function(t){var e=2*t.size,i=t.size,s='<svg class="pz_loading_circle spinner" width="'+(e-1)+'px" height="'+(e-1)+'px" viewBox="0 0 '+e+" "+e+'" xmlns="http://www.w3.org/2000/svg"><circle class="pz_loading_circle path" cx="'+i+'" cy="'+i+'" r="'+(i-3)+'"></circle></svg>';t.node.prepend(s)},add_loader_bar:function(t){new Mprogress({template:3,start:!0,parent:"#"+t.node.attr("id")+" .di_personalize_customized"})},register_hook:function(t,e){t in this.hooks||(this.hooks[t]=[]),this.hooks[t].push(e)},fire_hook:function(t){if(t in this.hooks){for(var e=0;e<this.hooks[t].length;e++)this.hooks[t][e](),jQuery(document).trigger("di_personalize_"+t);this.hooks[t]=[]}}};function loadPersonalization(){"interactive"!==document.readyState&&"complete"!==document.readyState||DI_Personalization_Site.init()}document.addEventListener("DOMContentLoaded",loadPersonalization),document.addEventListener("jellyfishLoaded",loadPersonalization);
